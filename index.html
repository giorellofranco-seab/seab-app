<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Plataforma SEAB</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d25d2a">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        /* Estilos base */
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background-color: #1a202c; }
        
        /* El Iframe (Tu App) */
        iframe {
            width: 100vw;
            height: 100vh;
            border: none;
            display: block;
            /* Oculto al principio para que no se vea el pantallazo blanco */
            opacity: 0; 
            transition: opacity 1s ease-in;
        }

        /* --- PANTALLA DE CARGA (SPLASH SCREEN) --- */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s ease-out, visibility 0.8s;
        }

        /* Animación del Logo */
        .splash-logo {
            width: 150px;
            height: 150px;
            object-fit: contain;
            animation: palpitar 2s infinite ease-in-out;
            margin-bottom: 20px;
        }

        /* Texto de carga */
        .loading-text {
            font-family: sans-serif;
            color: #a0aec0;
            font-size: 0.9rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            animation: parpadear 1.5s infinite;
        }

        /* Animaciones */
        @keyframes palpitar {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes parpadear {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Clase para ocultar el splash */
        .hidden-splash {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="splash-screen">
        <img src="icons/icon-192.png" alt="SEAB Logo" class="splash-logo">
        <div class="loading-text">Cargando Sistema...</div>
    </div>

    <iframe 
        id="app-frame"
        src="https://script.google.com/macros/s/AKfycbwVPQCBFhEmaMqkL6OuuphFQixeC_3iVJGP_oJ-rihCUS36INXRnOcqxodRRDbn8ibW/exec"
        sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation allow-downloads">
    </iframe>

    <script>
        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').catch(console.log);
        }

        // Lógica del Splash Screen
        const iframe = document.getElementById('app-frame');
        const splash = document.getElementById('splash-screen');

        // Cuando el iframe termina de cargar lo básico...
        iframe.onload = function() {
            // Esperamos un poquito más (2 segundos) para asegurar que GAS renderice
            setTimeout(() => {
                splash.classList.add('hidden-splash'); // Ocultar splash
                iframe.style.opacity = '1';            // Mostrar App
            }, 2500); 
        };

        // Fallback de seguridad: Si por alguna razón onload falla, quitar splash a los 8 segs
        setTimeout(() => {
            splash.classList.add('hidden-splash');
            iframe.style.opacity = '1';
        }, 8000);
    </script>
</body>
</html>

